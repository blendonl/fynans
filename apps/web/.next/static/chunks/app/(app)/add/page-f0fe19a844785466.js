(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{7225:(e,s,a)=>{Promise.resolve().then(a.bind(a,4325))},4325:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>Z});var t=a(4568),n=a(7620),l=a(3311),r=a(8367),i=a(5595),c=a(6547),d=a(6123),o=a(6284),m=a(9857);function x(){let e=(0,r.jE)(),s=(0,m.I)({queryKey:["expense-categories"],queryFn:async()=>((await o.u.get("/expense-categories")).data||[]).map(e=>({...e,isConnectedToStore:!!e.isConnectedToStore}))}),a=(0,m.I)({queryKey:["expense-item-categories"],queryFn:async()=>((await o.u.get("/expense-item-categories")).data||[]).map(e=>({...e,isConnectedToStore:!!e.isConnectedToStore}))}),t=(0,i.n)({mutationFn:async e=>{let{name:s,isConnectedToStore:a}=e,t=await o.u.post("/expense-categories",{name:s,isConnectedToStore:a});return{id:t.id,name:t.name,isConnectedToStore:!!t.isConnectedToStore}},onSuccess:()=>{e.invalidateQueries({queryKey:["expense-categories"]})}});return{categories:s.data||[],itemCategories:a.data||[],isLoading:s.isLoading,createCategory:t}}let u={name:"",price:"",discount:"",quantity:"1",categoryId:""};var p=a(4475),h=a(8202),j=a(4458),g=a(6826),y=a(5392),v=a(2393);let f=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)("textarea",{className:(0,v.cn)("flex min-h-[80px] w-full rounded-lg border border-border bg-surface px-3 py-2 text-sm text-text placeholder:text-text-disabled focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:cursor-not-allowed disabled:opacity-50 transition-colors",a),ref:s,...n})});f.displayName="Textarea";var N=a(3056),b=a(9185),w=a(8650),C=a(6599),S=a(6892);let I=b.bL;b.YJ;let A=b.WT,F=n.forwardRef((e,s)=>{let{className:a,children:n,...l}=e;return(0,t.jsxs)(b.l9,{ref:s,className:(0,v.cn)("flex h-10 w-full items-center justify-between rounded-lg border border-border bg-surface px-3 py-2 text-sm text-text placeholder:text-text-disabled focus:outline-none focus:ring-2 focus:ring-primary disabled:cursor-not-allowed disabled:opacity-50",a),...l,children:[n,(0,t.jsx)(b.In,{asChild:!0,children:(0,t.jsx)(w.A,{className:"h-4 w-4 opacity-50"})})]})});F.displayName=b.l9.displayName;let L=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(b.PP,{ref:s,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(C.A,{className:"h-4 w-4"})})});L.displayName=b.PP.displayName;let E=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(b.wn,{ref:s,className:(0,v.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(w.A,{className:"h-4 w-4"})})});E.displayName=b.wn.displayName;let R=n.forwardRef((e,s)=>{let{className:a,children:n,position:l="popper",...r}=e;return(0,t.jsx)(b.ZL,{children:(0,t.jsxs)(b.UC,{ref:s,className:(0,v.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-lg border border-border bg-surface text-text shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...r,children:[(0,t.jsx)(L,{}),(0,t.jsx)(b.LM,{className:(0,v.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,t.jsx)(E,{})]})})});R.displayName=b.UC.displayName;let k=n.forwardRef((e,s)=>{let{className:a,children:n,...l}=e;return(0,t.jsxs)(b.q7,{ref:s,className:(0,v.cn)("relative flex w-full cursor-default select-none items-center rounded-md py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-selection-bg focus:text-text data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(b.VF,{children:(0,t.jsx)(S.A,{className:"h-4 w-4"})})}),(0,t.jsx)(b.p4,{children:n})]})});k.displayName=b.q7.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(b.JU,{ref:s,className:(0,v.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=b.JU.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(b.wv,{ref:s,className:(0,v.cn)("-mx-1 my-1 h-px bg-border",a),...n})}).displayName=b.wv.displayName;var q=a(2148),P=a(3312),J=a(9880),O=a(2115);function T(e){let{categories:s,selectedCategory:a,onSelect:l,onClear:r,onCreateNew:i,isLoading:c}=e,[d,o]=(0,n.useState)(""),[m,x]=(0,n.useState)(!1),u=(0,n.useMemo)(()=>d.trim()?s.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())):s,[s,d]),p=u.some(e=>e.name.toLowerCase()===d.toLowerCase());return a&&!m?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text",children:"Category"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(O.E,{variant:"default",className:"gap-1 py-1.5 px-3",children:[(0,t.jsx)(q.A,{className:"h-3 w-3"}),a.name,(0,t.jsx)("button",{onClick:r,className:"ml-1 hover:opacity-70",children:(0,t.jsx)(P.A,{className:"h-3 w-3"})})]})})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text",children:"Category"}),(0,t.jsx)(g.p,{placeholder:"Type or select a category",value:d,onChange:e=>{o(e.target.value),x(!0)},onFocus:()=>x(!0)}),m&&(d.trim()||s.length>0)&&(0,t.jsx)("div",{className:"border border-border rounded-lg bg-dropdown-bg shadow-md max-h-48 overflow-y-auto",children:c?(0,t.jsx)("div",{className:"p-3 text-sm text-text-secondary",children:"Loading..."}):(0,t.jsxs)(t.Fragment,{children:[u.map(e=>(0,t.jsxs)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-dropdown-hover transition-colors",onClick:()=>{l(e),o(""),x(!1)},children:[e.name,e.isConnectedToStore&&(0,t.jsx)("span",{className:"ml-2 text-xs text-text-secondary",children:"(store)"})]},e.id)),d.trim()&&!p&&(0,t.jsxs)(j.$,{variant:"ghost",className:"w-full justify-start text-primary",onClick:()=>{i(d.trim()),o(""),x(!1)},children:[(0,t.jsx)(J.A,{className:"h-4 w-4 mr-2"}),'Create "',d.trim(),'"']})]})})]})}var $=a(7668);function M(e){let{stores:s,selectedStore:a,onSelect:l,onClear:r,onSearch:i,onCreateNew:c,isLoading:d}=e,[o,m]=(0,n.useState)(""),[x,u]=(0,n.useState)(!1);return a?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text",children:"Store"}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(O.E,{variant:"secondary",className:"gap-1 py-1.5 px-3",children:[(0,t.jsx)($.A,{className:"h-3 w-3"}),a.name,(0,t.jsx)("button",{onClick:r,className:"ml-1 hover:opacity-70",children:(0,t.jsx)(P.A,{className:"h-3 w-3"})})]})})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-text",children:"Store"}),(0,t.jsx)(g.p,{placeholder:"Search for a store",value:o,onChange:e=>{m(e.target.value),i(e.target.value),u(!0)},onFocus:()=>u(!0)}),x&&o.trim()&&(0,t.jsx)("div",{className:"border border-border rounded-lg bg-dropdown-bg shadow-md max-h-48 overflow-y-auto",children:d?(0,t.jsx)("div",{className:"p-3 text-sm text-text-secondary",children:"Loading..."}):(0,t.jsxs)(t.Fragment,{children:[s.map(e=>(0,t.jsxs)("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-dropdown-hover transition-colors",onClick:()=>{l(e),m(""),u(!1)},children:[(0,t.jsx)("p",{children:e.name}),(0,t.jsx)("p",{className:"text-xs text-text-secondary",children:e.location})]},e.id)),(0,t.jsxs)(j.$,{variant:"ghost",className:"w-full justify-start text-primary",onClick:()=>{c(o.trim()),m(""),u(!1)},children:[(0,t.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"Add new store"]})]})})]})}var U=a(9437),D=a(5677);function V(e){let{item:s,index:a,onEdit:n,onRemove:l}=e,r=(s.price-s.discount)*s.quantity;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-surface-variant",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-text",children:s.name}),(0,t.jsxs)("p",{className:"text-xs text-text-secondary",children:[(0,d.vv)(s.price)," \xd7 ",(0,d.VZ)(s.quantity),s.discount>0&&" - ".concat((0,d.vv)(s.discount)," discount")]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-text",children:(0,d.vv)(r)}),(0,t.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>n(a),children:(0,t.jsx)(U.A,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(j.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-error",onClick:()=>l(a),children:(0,t.jsx)(D.A,{className:"h-3.5 w-3.5"})})]})]})}function K(e){let{items:s,currentItem:a,itemCategories:n,editingIndex:l,itemErrors:r,onCurrentItemChange:i,onAddItem:c,onEditItem:d,onCancelEdit:o,onRemoveItem:m}=e;return(0,t.jsxs)("div",{className:"space-y-4",children:[s.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(y.J,{children:["Items (",s.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:s.map((e,s)=>(0,t.jsx)(V,{item:e,index:s,onEdit:d,onRemove:m},s))})]}),(0,t.jsxs)("div",{className:"border border-border rounded-lg p-4 space-y-3",children:[(0,t.jsx)(y.J,{children:null!==l?"Edit Item":"Add Item"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsx)(g.p,{placeholder:"Item name",value:a.name,onChange:e=>i({...a,name:e.target.value})}),r.name&&(0,t.jsx)("p",{className:"text-xs text-error mt-1",children:r.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(g.p,{type:"number",placeholder:"Price",value:a.price,onChange:e=>i({...a,price:e.target.value}),step:"0.01",min:"0"}),r.price&&(0,t.jsx)("p",{className:"text-xs text-error mt-1",children:r.price})]}),(0,t.jsx)("div",{children:(0,t.jsx)(g.p,{type:"number",placeholder:"Quantity",value:a.quantity,onChange:e=>i({...a,quantity:e.target.value}),step:"0.1",min:"0.1"})}),(0,t.jsx)("div",{children:(0,t.jsx)(g.p,{type:"number",placeholder:"Discount (optional)",value:a.discount,onChange:e=>i({...a,discount:e.target.value}),step:"0.01",min:"0"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(I,{value:a.categoryId,onValueChange:e=>i({...a,categoryId:e}),children:[(0,t.jsx)(F,{children:(0,t.jsx)(A,{placeholder:"Category"})}),(0,t.jsx)(R,{children:n.map(e=>(0,t.jsx)(k,{value:e.id,children:e.name},e.id))})]}),r.categoryId&&(0,t.jsx)("p",{className:"text-xs text-error mt-1",children:r.categoryId})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(j.$,{onClick:c,className:"flex-1",children:[null!==l?(0,t.jsx)(S.A,{className:"h-4 w-4 mr-2"}):(0,t.jsx)(J.A,{className:"h-4 w-4 mr-2"}),null!==l?"Update":"Add Item"]}),null!==l&&(0,t.jsxs)(j.$,{variant:"outline",onClick:o,children:[(0,t.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Cancel"]})]})]})]})}function Y(e){let{steps:s}=e;return(0,t.jsx)("div",{className:"flex items-center gap-2 mb-6",children:s.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,v.cn)("h-7 w-7 rounded-full flex items-center justify-center text-xs font-medium transition-colors",e.completed?"bg-primary text-white":e.active?"bg-primary/20 text-primary border border-primary":"bg-surface-variant text-text-disabled"),children:e.completed?(0,t.jsx)(S.A,{className:"h-3.5 w-3.5"}):a+1}),(0,t.jsx)("span",{className:(0,v.cn)("text-xs",e.completed||e.active?"text-text":"text-text-disabled"),children:e.label}),a<s.length-1&&(0,t.jsx)("div",{className:(0,v.cn)("h-px w-6",e.completed?"bg-primary":"bg-border")})]},e.label))})}var _=a(8702);function Q(e){let{open:s,onOpenChange:a,initialName:l,onSubmit:r,isLoading:i}=e,[c,d]=(0,n.useState)(l),[o,m]=(0,n.useState)(!1);return(0,t.jsx)(_.lG,{open:s,onOpenChange:a,children:(0,t.jsxs)(_.Cf,{children:[(0,t.jsx)(_.c7,{children:(0,t.jsx)(_.L3,{children:"Create Category"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Category Name"}),(0,t.jsx)(g.p,{value:c,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"connectedToStore",checked:o,onChange:e=>m(e.target.checked),className:"rounded border-border"}),(0,t.jsx)(y.J,{htmlFor:"connectedToStore",children:"Connected to store"})]})]}),(0,t.jsxs)(_.Es,{children:[(0,t.jsx)(j.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsx)(j.$,{onClick:()=>r(c,o),loading:i,children:"Create"})]})]})})}function W(e){let{open:s,onOpenChange:a,initialName:l,onSubmit:r,isLoading:i}=e,[c,d]=(0,n.useState)(l),[o,m]=(0,n.useState)("");return(0,t.jsx)(_.lG,{open:s,onOpenChange:a,children:(0,t.jsxs)(_.Cf,{children:[(0,t.jsx)(_.c7,{children:(0,t.jsx)(_.L3,{children:"Add Store"})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Store Name"}),(0,t.jsx)(g.p,{value:c,onChange:e=>d(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Location"}),(0,t.jsx)(g.p,{value:o,onChange:e=>m(e.target.value),placeholder:"Store location"})]})]}),(0,t.jsxs)(_.Es,{children:[(0,t.jsx)(j.$,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,t.jsx)(j.$,{onClick:()=>r(c,o),loading:i,disabled:!c.trim()||!o.trim(),children:"Create"})]})]})})}function Z(){let e=(0,l.useRouter)(),s=(0,r.jE)(),[a,i]=(0,n.useState)("expense");return(0,t.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-text",children:"Add Transaction"}),(0,t.jsxs)(h.tU,{value:a,onValueChange:i,children:[(0,t.jsxs)(h.j7,{className:"w-full",children:[(0,t.jsx)(h.Xi,{value:"expense",className:"flex-1",children:"Expense"}),(0,t.jsx)(h.Xi,{value:"income",className:"flex-1",children:"Income"})]}),(0,t.jsx)(h.av,{value:"expense",children:(0,t.jsx)(z,{onSuccess:()=>{s.invalidateQueries({queryKey:["transactions"]}),e.push("/transactions")}})}),(0,t.jsx)(h.av,{value:"income",children:(0,t.jsx)(B,{onSuccess:()=>{s.invalidateQueries({queryKey:["transactions"]}),e.push("/transactions")}})})]})]})}function z(e){let{onSuccess:s}=e,{categories:a,itemCategories:l,isLoading:h,createCategory:v}=x(),[f,b]=(0,n.useState)(""),{stores:w,isLoading:C,createStore:S}=function(e){let s=(0,r.jE)(),a=(0,m.I)({queryKey:["stores",e],queryFn:async()=>e&&(await o.u.get("/stores",{search:e})).data||[],enabled:e.length>0}),t=(0,i.n)({mutationFn:async e=>{let{name:s,location:a}=e;return await o.u.post("/stores",{name:s,location:a})},onSuccess:()=>{s.invalidateQueries({queryKey:["stores"]})}});return{stores:a.data||[],isLoading:a.isLoading,createStore:t}}(f),L=function(){let[e,s]=(0,n.useState)([]),[a,t]=(0,n.useState)({...u}),[l,r]=(0,n.useState)(null),[i,c]=(0,n.useState)({});return{items:e,currentItem:a,editingIndex:l,itemErrors:i,setItems:s,setCurrentItem:t,handleAddItem:()=>{var n;let i={};if((null===(n=a.name)||void 0===n?void 0:n.trim())||(i.name="Please enter item name"),(!a.price||0>=parseFloat(a.price))&&(i.price="Please enter a valid price"),a.categoryId||(i.categoryId="Please select an item category"),Object.keys(i).length>0){c(i);return}c({});let d={name:a.name,price:parseFloat(a.price),discount:a.discount?parseFloat(a.discount):0,quantity:parseFloat(a.quantity)||1,categoryId:a.categoryId,fromReceipt:a.fromReceipt};if(null!==l){let a=[...e];a[l]=d,s(a),r(null)}else s([...e,d]);t({...u})},handleRemoveItem:a=>{s(e.filter((e,s)=>s!==a))},handleEditItem:s=>{let a=e[s];t({name:a.name,price:a.price.toString(),discount:a.discount>0?a.discount.toString():"",quantity:a.quantity.toString(),categoryId:a.categoryId,fromReceipt:a.fromReceipt}),r(s),c({})},cancelEdit:()=>{r(null),t({...u}),c({})}}}(),{families:E}=(0,p.c)(),[q,P]=(0,n.useState)(null),[J,O]=(0,n.useState)(null),[$,U]=(0,n.useState)(!1),[D,V]=(0,n.useState)(""),[_,Z]=(0,n.useState)(""),[z,B]=(0,n.useState)("PERSONAL"),[X,G]=(0,n.useState)(""),[H,ee]=(0,n.useState)(new Date().toISOString().slice(0,16)),[es,ea]=(0,n.useState)(!1),[et,en]=(0,n.useState)(""),[el,er]=(0,n.useState)(!1),[ei,ec]=(0,n.useState)(""),ed=(null==q?void 0:q.isConnectedToStore)===!0,eo=(0,i.n)({mutationFn:async()=>{let e=$?L.items.map(e=>({categoryId:e.categoryId,itemName:e.name,itemPrice:e.price,discount:e.discount,quantity:e.quantity})):[{categoryId:q.id,itemName:_.trim()||q.name,itemPrice:parseFloat(D),discount:0,quantity:1}];await o.u.post("/expenses",{categoryId:q.id,storeName:ed?null==J?void 0:J.name:void 0,storeLocation:ed?null==J?void 0:J.location:void 0,recordedAt:new Date(H).toISOString(),scope:z,familyId:"FAMILY"===z?X:null,items:e})},onSuccess:()=>{let e=$?L.items.reduce((e,s)=>e+(s.price-s.discount)*s.quantity,0):parseFloat(D);c.oR.success("Expense created: ".concat((0,d.vv)(e))),s()},onError:e=>{c.oR.error(e.message||"Failed to create expense")}}),em=()=>!!q&&($?L.items.length>0:""!==D&&parseFloat(D)>0),ex=[{label:"Category",completed:null!==q,active:null===q},...ed?[{label:"Store",completed:null!==J,active:null!==q&&!J}]:[],{label:"Items",completed:L.items.length>0,active:null!==q&&0===L.items.length},{label:"Review",completed:!1,active:em()}];return(0,t.jsx)(N.Zp,{className:"mt-4",children:(0,t.jsxs)(N.Wu,{className:"p-6 space-y-6",children:[(0,t.jsx)(T,{categories:a,selectedCategory:q,onSelect:P,onClear:()=>P(null),onCreateNew:e=>{en(e),ea(!0)},isLoading:h}),q&&!$&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Amount"}),(0,t.jsx)(g.p,{type:"number",placeholder:"0.00",value:D,onChange:e=>V(e.target.value),step:"0.01",min:"0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Note (optional)"}),(0,t.jsx)(g.p,{placeholder:"What was this expense for?",value:_,onChange:e=>Z(e.target.value)})]}),(0,t.jsx)(j.$,{variant:"ghost",className:"text-primary",onClick:()=>U(!0),children:"Break down into items"})]}),q&&$&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y,{steps:ex}),ed&&(0,t.jsx)(M,{stores:w,selectedStore:J,onSelect:O,onClear:()=>O(null),onSearch:b,onCreateNew:e=>{ec(e),er(!0)},isLoading:C}),(0,t.jsx)(K,{items:L.items,currentItem:L.currentItem,itemCategories:l,editingIndex:L.editingIndex,itemErrors:L.itemErrors,onCurrentItemChange:L.setCurrentItem,onAddItem:L.handleAddItem,onEditItem:L.handleEditItem,onCancelEdit:L.cancelEdit,onRemoveItem:L.handleRemoveItem})]}),q&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Scope"}),(0,t.jsxs)(I,{value:z,onValueChange:e=>B(e),children:[(0,t.jsx)(F,{children:(0,t.jsx)(A,{})}),(0,t.jsxs)(R,{children:[(0,t.jsx)(k,{value:"PERSONAL",children:"Personal"}),(0,t.jsx)(k,{value:"FAMILY",children:"Family"})]})]})]}),"FAMILY"===z&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Family"}),(0,t.jsxs)(I,{value:X,onValueChange:G,children:[(0,t.jsx)(F,{children:(0,t.jsx)(A,{placeholder:"Select family"})}),(0,t.jsx)(R,{children:E.map(e=>(0,t.jsx)(k,{value:e.id,children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Date & Time"}),(0,t.jsx)(g.p,{type:"datetime-local",value:H,onChange:e=>ee(e.target.value)})]}),(0,t.jsx)(j.$,{className:"w-full",onClick:()=>eo.mutate(),loading:eo.isPending,disabled:!em(),children:"Create Expense"})]}),(0,t.jsx)(Q,{open:es,onOpenChange:ea,initialName:et,onSubmit:async(e,s)=>{P(await v.mutateAsync({name:e,isConnectedToStore:s})),ea(!1)},isLoading:v.isPending}),(0,t.jsx)(W,{open:el,onOpenChange:er,initialName:ei,onSubmit:async(e,s)=>{O(await S.mutateAsync({name:e,location:s})),er(!1)},isLoading:S.isPending})]})})}function B(e){let{onSuccess:s}=e,{categories:a,isLoading:l,createCategory:r}=x(),{families:m}=(0,p.c)(),[u,h]=(0,n.useState)(null),[v,b]=(0,n.useState)(""),[w,C]=(0,n.useState)(""),[S,L]=(0,n.useState)("PERSONAL"),[E,q]=(0,n.useState)(""),[P,J]=(0,n.useState)(new Date().toISOString().slice(0,16)),[O,$]=(0,n.useState)(!1),[M,U]=(0,n.useState)(""),D=(0,i.n)({mutationFn:async()=>{await o.u.post("/transactions",{type:"INCOME",value:parseFloat(v),description:w,categoryId:u.id,recordedAt:new Date(P).toISOString(),familyId:"FAMILY"===S?E:void 0})},onSuccess:()=>{c.oR.success("Income created: ".concat((0,d.vv)(parseFloat(v)))),s()},onError:e=>{c.oR.error(e.message||"Failed to create income")}}),V=u&&v&&parseFloat(v)>0;return(0,t.jsx)(N.Zp,{className:"mt-4",children:(0,t.jsxs)(N.Wu,{className:"p-6 space-y-6",children:[(0,t.jsx)(T,{categories:a,selectedCategory:u,onSelect:h,onClear:()=>h(null),onCreateNew:e=>{U(e),$(!0)},isLoading:l}),u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Amount"}),(0,t.jsx)(g.p,{type:"number",placeholder:"0.00",value:v,onChange:e=>b(e.target.value),step:"0.01",min:"0"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Description (optional)"}),(0,t.jsx)(f,{placeholder:"What was this income for?",value:w,onChange:e=>C(e.target.value)})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Scope"}),(0,t.jsxs)(I,{value:S,onValueChange:e=>L(e),children:[(0,t.jsx)(F,{children:(0,t.jsx)(A,{})}),(0,t.jsxs)(R,{children:[(0,t.jsx)(k,{value:"PERSONAL",children:"Personal"}),(0,t.jsx)(k,{value:"FAMILY",children:"Family"})]})]})]}),"FAMILY"===S&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Family"}),(0,t.jsxs)(I,{value:E,onValueChange:q,children:[(0,t.jsx)(F,{children:(0,t.jsx)(A,{placeholder:"Select family"})}),(0,t.jsx)(R,{children:m.map(e=>(0,t.jsx)(k,{value:e.id,children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.J,{children:"Date & Time"}),(0,t.jsx)(g.p,{type:"datetime-local",value:P,onChange:e=>J(e.target.value)})]}),(0,t.jsx)(j.$,{className:"w-full",onClick:()=>D.mutate(),loading:D.isPending,disabled:!V,children:"Create Income"})]}),(0,t.jsx)(Q,{open:O,onOpenChange:$,initialName:M,onSubmit:async(e,s)=>{h(await r.mutateAsync({name:e,isConnectedToStore:s})),$(!1)},isLoading:r.isPending})]})})}},5392:(e,s,a)=>{"use strict";a.d(s,{J:()=>i});var t=a(4568),n=a(7620),l=a(8157),r=a(2393);let i=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.b,{ref:s,className:(0,r.cn)("text-sm font-medium text-text leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",a),...n})});i.displayName=l.b.displayName},8202:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>d,av:()=>o,j7:()=>c,tU:()=>i});var t=a(4568),n=a(7620),l=a(8420),r=a(2393);let i=l.bL,c=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.B8,{ref:s,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-surface-variant p-1 text-text-secondary",a),...n})});c.displayName=l.B8.displayName;let d=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.l9,{ref:s,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-surface data-[state=active]:text-text data-[state=active]:shadow-sm cursor-pointer",a),...n})});d.displayName=l.l9.displayName;let o=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(l.UC,{ref:s,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary",a),...n})});o.displayName=l.UC.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[959,999,857,772,961,70,520,739,607,547,713,231,587,855,358],()=>s(7225)),_N_E=e.O()}]);
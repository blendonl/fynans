model Expense {
  id            String
  transactionId String @unique @map("transaction_id")
  storeId       String? @map("store_id")
  categoryId    String @map("category_id")

  description String? 
  category    ExpenseCategory @relation(fields: [categoryId], references: [id])

  transaction Transaction   @relation(fields: [transactionId], references: [id])
  store       Store?        @relation(fields: [storeId], references: [id])
  items       ExpenseItem[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@id([id])
  @@map("expense")
}

model ExpenseCategory {
  id       String  @id @default(uuid())
  parentId String? @map("parent_id")

  name             String  @unique
  isConnectedToStore Boolean @default(false)


  parent   ExpenseCategory?  @relation(name: "children", fields: [parentId], references: [id])
  children ExpenseCategory[] @relation(name: "children")
  expenses Expense[]
  users    UserExpenseCategory[]

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("expense_category")
}

model UserExpenseCategory {
  id         String @id @default(uuid())
  userId     String @map("user_id")
  categoryId String @map("category_id")

  user     User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  category ExpenseCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now()) @map("created_at")

  @@unique([userId, categoryId])
  @@index([userId])
  @@index([categoryId])
  @@map("user_expense_category")
}
